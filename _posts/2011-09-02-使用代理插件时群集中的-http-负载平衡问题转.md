---
id: 2242
title: '使用代理插件时群集中的 HTTP 负载平衡问题[转]'
date: 2011-09-02T19:26:00+00:00
author: 刘长炯
layout: post
guid: http://www.beansoft.biz/?p=2242
permalink: '/2011/09/02/%e4%bd%bf%e7%94%a8%e4%bb%a3%e7%90%86%e6%8f%92%e4%bb%b6%e6%97%b6%e7%be%a4%e9%9b%86%e4%b8%ad%e7%9a%84-http-%e8%b4%9f%e8%bd%bd%e5%b9%b3%e8%a1%a1%e9%97%ae%e9%a2%98%e8%bd%ac/'
views:
  - "3308"
original_post_id:
  - "2242"
image: /wp-content/uploads/2012/04/WebLogic.png
categories:
  - WebLogic
---
<table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
  <tr>
    <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
      <font style="color: rgb(0,0,0)" color="#009900"><b><u>问题描述</u></b></font></p> 
      
      <p>
        HTTP 请求在 WebLogic 群集节点之间的负载平衡不均，即，群集中一个或多个节点接收和执行的 HTTP 请求比同一群集中的其它节点多。</td> </tr> </tbody> </table> 
        
        <p>
          <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
        </p>
        
        <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
          <tr>
            <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
              <font color="#009900"><span style="color: rgb(0,0,0); font-weight: bold; text-decoration: underline">故障排除</span><u><b><br /> <br /></b></u></font>请注意，并非下面所有任务都需要完成。有些问题仅通过执行几项任务就可以解决。</p> 
              
              <p>
                <font color="#009900"><span style="color: rgb(0,0,0); font-weight: bold">快速链接</span></font>
              </p>
              
              <ul style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                  <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://blog.middleware123.com/support_pattern/HTTP_Load_Balance_Problems_in_Cluster_Using_Proxy_Plug-in_Pattern.html#Why_does_the_problem_occur">为什么发生此问题？</a>
                </li>
                <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                  <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://blog.middleware123.com/support_pattern/HTTP_Load_Balance_Problems_in_Cluster_Using_Proxy_Plug-in_Pattern.html#Diagnosis">诊断</a>
                </li>
                <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                  <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://blog.middleware123.com/support_pattern/HTTP_Load_Balance_Problems_in_Cluster_Using_Proxy_Plug-in_Pattern.html#Resolution">解决方法</a>
                </li>
                <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                  <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://blog.middleware123.com/support_pattern/HTTP_Load_Balance_Problems_in_Cluster_Using_Proxy_Plug-in_Pattern.html#External_Resources">外部资源</a>
                </li>
              </ul>
              
              <p>
                <u><font style="color: rgb(0,0,0); font-weight: bold" color="#009900"><span style="text-decoration: underline"><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" name="Why_does_the_problem_occur"></a>为什么发生此问题？</span></font></u>
              </p>
              
              <p>
                在群集中出现的 HTTP 请求负载平衡不均问题具有以下特征：
              </p>
              
              <p>
                <span style="font-weight: bold"><br /> <br />由于 HTTP 会话分配不均造成 HTTP 请求的负载平衡不均</span>
              </p>
              
              <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                代理将不包含会话 cookie 的请求转发到基于 round-robin 负载平衡模式的群集节点，并在该节点上创建新会话。理想状态下，所有群集节点应当接收等量的 HTTP 会话。如果没有出现这种情况，则由于负载平衡策略的“粘性”特点，接收较多会话的节点将得到比其它节点数量更多的请求。最终结果是造成群集节点之间负载分配不均。
              </p>
              
              <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                包含会话 cookie 的请求总是被转发到作为会话的“primary”主机的节点，这被称为粘性负载平衡或基于会话粘连的负载平衡。对不均匀负载平衡的探查不适用于此类型的请求。
              </p>
            </td>
          </tr>
        </table>
        
        <p>
          <span style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; display: inline !important; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; float: none; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">含有会话 cookie 的请求在代理调试日志中有类似以下形式的日志条目：</span>
        </p>
        
        <p>
          <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
        </p>
        
        <table style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: &#39;courier new&#39;; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" border="1" cellspacing="2" cellpadding="2">
          <tr>
            <td style="background-color: rgb(204,204,204); font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
              Mon May 10<span class="Apple-converted-space">&#160;</span><time hour="13" minute="14">13:14:40</time><span class="Apple-converted-space">&#160;</span>2004 Parsing cookie JSESSIONID=Af48B06Xe6BvewE8yCNWKz62dsiu028qlO9GvkS41bg3n53RbJ2Z!-2032354160!-457294087<span class="Apple-converted-space">&#160;</span></p> 
              
              <p>
                Mon May 10 13:14:40 2004 getpreferredServersFromCookie: -2032354160!-457294087<span class="Apple-converted-space">&#160;</span>
              </p>
              
              <p>
                Mon May 10 13:14:40 2004 Hdrs from Client:[cookie]=[JSESSIONID=Af48B06Xe6BvewE8yCNWKz62dsiu028qlO9GvkS41bg3n53RbJ2Z!-
              </p>
              
              <p>
                2032354160!-457294087]</td> </tr> </tbody> </table> 
                
                <p>
                  <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
                </p>
                
                <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                  <tr>
                    <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                      <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                        代理插件维护一个称为“常规服务器列表”的内存中列表，该列表包含在任一时间点已知处于良好运行状态 (Status:OK) 的群集节点。插件使用常规服务器列表来确定选择哪一个群集节点，以便转发不包含会话 cookie 的请求。如果没有出现任何问题，则常规服务器列表将与用插件配置的静态列表相同。
                      </p>
                      
                      <p>
                        有一些情况（如下所述）会导致常规服务器列表收缩而成为静态列表的一个子集。当出现这种问题时，插件转发不包含会话 cookie 的请求的可用节点就会大大减少，结果 HTTP 会话的分配将变得不均。</td> </tr> </tbody> </table> 
                        
                        <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                          <tr>
                            <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                              <span style="font-weight: bold">影响</span><b>常规服务器列表的因素</b></p> 
                              
                              <ol style="line-height: 18px; list-style-type: lower-alpha; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                  <b>&#160;</b>来自某个群集节点的响应流中的 X-WebLogic-Cluster-List HTTP 报头，该群集节点为特定请求提供服务。
                                </li>
                              </ol>
                            </td>
                          </tr>
                        </table><table style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2" 1?="1?" unselectable="on"> 
                        
                        <tr>
                          <td style="background-color: rgb(204,204,204); font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                            <b>什么是 X-WebLogic-Cluster-List HTTP 报头？</b></p> 
                            
                            <p>
                              后端 Weblogic Server 通过响应流中的 HTTP 报头 X-WebLogic-Request-ClusterInfo 处理来自插件的请求，并将已知的活动群集成员列表返回在该点上的插件。只有在更改群集列表时才会返回该报头。
                            </p>
                            
                            <p>
                              </td> </tr> </tbody> </table> 
                              
                              <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; height: 4px; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                              </table>
                              
                              <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                                <tr>
                                  <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                    如果返回的群集列表被截断，在插件的常规服务器列表也将变成完整群集列表的子集。当后端群集节点在其自己的群集视图中有一个群集节点子集时，该节点将返回被截断的列表。<br /> <br />这是负载平衡问题的最常见原因。
                                  </td>
                                </tr>
                              </table>
                              
                              <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; height: 4px; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                                <tr>
                                  <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                    <ol style="line-height: 18px; list-style-type: lower-alpha; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px" start="start">
                                      <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                        当插件试图获取某个群集节点提供服务的请求时（即向某个群集节点发送 http 请求或从群集节点读取响应时），就会出现任何异常。
                                      </li>
                                    </ol>
                                    
                                    <div style="margin-left: 40px">
                                      如果在此过程出现异常，则该群集节点将会被标记为错误，并被临时从常规服务器列表中删除。
                                    </div>
                                  </td>
                                </tr>
                              </table>
                              
                              <p>
                                <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" /><a style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px arial, verdana, helvetica, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(226,7,37); word-spacing: 0px; text-decoration: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" href="#TOP">返回页首</a>
                              </p>
                              
                              <p>
                                <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
                              </p>
                              
                              <p>
                                <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
                              </p>
                              
                              <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                                <tr>
                                  <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                    <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" name="Diagnosis"></a><span style="font-weight: bold; text-decoration: underline">诊断</span></p> 
                                    
                                    <p>
                                    </p>
                                    
                                    <ol style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                      <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                        配置代理插件以生成更多诊断数据。有关详细信息，请参考<a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://blog.middleware123.com/support_pattern/General_Diagnostic_Process_for_Problems_with_Proxy_Plug_in_Pattern.html">利用代理插件的问题常规诊断过程</a>。 <p>
                                          </li> </ol> 
                                          
                                          <ol style="line-height: 18px; list-style-type: decimal; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px" start="start">
                                            <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                              查看代理桥接器页面的常规服务器列表
                                            </li>
                                          </ol>
                                          
                                          <div style="margin-left: 40px">
                                            如果列表没有显示具有 Status:<span class="Apple-converted-space">&#160;</span><span style="font-weight: bold">OK</span>（状态: 正常）的所有群集节点，则常规服务器列表已经被截断以包含节点子集。
                                          </div></td> </tr> </tbody> </table> 
                                          
                                          <table style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" border="1" cellspacing="2" cellpadding="2">
                                            <tr>
                                              <td style="background-color: rgb(204,204,204); font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                <b>原始：</b><span class="Apple-converted-space">&#160;</span></p> 
                                                
                                                <p>
                                                  <span style="font-family: &#39;courier new&#39;">General Server List:</span>
                                                </p>
                                                
                                                <ol style="line-height: 18px; list-style-type: decimal; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                  <li style="line-height: 18px; font-family: &#39;courier new&#39;; color: rgb(0,0,0); font-size: 12px">
                                                    Host: &#8216;172.18.137.50&#8217; Port: 8001 Status: OK
                                                  </li>
                                                  <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                    <span style="font-family: &#39;courier new&#39;">Host: &#8216;172.18.137.54&#8217; Port: 8001 Status: OK</span>
                                                  </li>
                                                </ol>
                                                
                                                <p>
                                                  <b>被截断：</b><span class="Apple-converted-space">&#160;</span>
                                                </p>
                                                
                                                <p>
                                                  <span style="font-family: &#39;courier new&#39;">General Server List:</span>
                                                </p>
                                                
                                                <ol style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px" type="1">
                                                  <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                    <span style="font-family: &#39;courier new&#39;">Host: &#8216;172.18.137.50&#8217; Port: 8001 Status: OK</span>
                                                  </li>
                                                </ol>
                                              </td>
                                            </tr>
                                          </table>
                                          
                                          <p>
                                            <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
                                          </p>
                                          
                                          <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; height: 1px; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                                            <tr>
                                              <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                <ol style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px" start="start">
                                                  <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                    下一步是确定哪一个因素，(a) 还是 (b)，或者两个因素合在一起引起此问题。
                                                  </li>
                                                </ol>
                                                
                                                <ol style="line-height: 18px; list-style-type: lower-alpha; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                  <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                    被截断的 X-WebLogic-Cluster-List
                                                  </li>
                                                </ol>
                                                
                                                <div style="margin-left: 40px">
                                                  在代理日志中搜索 X-WebLogic-Cluster-List，并查看什么时候后端群集节点已经返回被截断的列表。通过跟踪同一请求的前一个日志条目，确定哪一个后端群集节点已经返回被截断的 X-WebLogic-Cluster-List。
                                                </div>
                                              </td>
                                            </tr>
                                          </table>
                                          
                                          <div style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" align="left">
                                            <table style="width: 615px; height: 61px" border="1" cellspacing="2" cellpadding="2">
                                              <tr>
                                                <td style="background-color: rgb(204,204,204); font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                  <span style="font-weight: bold">完整群集列表：</span></p> 
                                                  
                                                  <p>
                                                    <span style="font-family: &#39;courier new&#39;">Mon May 10 13:14:30 2004 Hdrs from WLS:[X-WebLogic-Cluster-Hash]=[sUuYnuyhFpkhw6ty<br /> <br />44bkNczWnaA]</span><span class="Apple-converted-space">&#160;</span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Mon May 10 13:14:30 2004 Hdrs from WLS:[X-WebLogic-Cluster-List]=[-2032354160!-1408071374!38625!-1|-457294087!-<br /> <br />408071370!38625!-1]</span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">…………………</span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Mon May 10 13:14:30 2004 Parsing cluster list: -2032354160!-1408071374!38625!-1|-457294087!-1408071370!38625!-1<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Mon May 10 13:14:30 2004 Initializing lastIndex=0 for a list of length=2<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Mon May 10 13:14:30 2004 ### Got a new Server List of length 2 ###<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Mon May 10 13:14:30 2004 ###Response### : Srvr# [1] = [172.18.137.50:38625:65535]<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Mon May 10 13:14:30 2004 ###Response### : Srvr# [2] = [172.18.137.54:38625:65535]<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    &#160;<span class="Apple-converted-space">&#160;</span>
                                                  </p>
                                                  
                                                  <p>
                                                    <b>被截断的群集列表：</b><span class="Apple-converted-space">&#160;</span>
                                                  </p>
                                                  
                                                  <p>
                                                    <span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:01 2004 Hdrs from WLS:[X-WebLogic-Cluster-Hash]=[O2ukNQEbMOLzU+R2026DpZaYVtI]<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:01 2004 Hdrs from WLS:[X-WebLogic-Cluster-List]=[848189891!-1408071374!38625!-1]<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">…………………<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:01 2004 Parsing cluster list: 848189891!-1408071374!38625!-1<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:01 2004 Initializing lastIndex=0 for a list of length=1<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:01 2004 ### Got a new Server List of length 1 ###<span class="Apple-converted-space">&#160;</span></span>
                                                  </p>
                                                  
                                                  <p>
                                                    <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:01 2004 ###Response### : Srvr# [1] = [172.18.137.50:38625:65535]</span></td> </tr> </tbody> </table> 
                                                    
                                                    <p>
                                                    </p>
                                                    
                                                    <table style="text-align: left; width: 615px" cellspacing="2" cellpadding="2">
                                                      <tr>
                                                        <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                          <ol style="line-height: 18px; list-style-type: lower-alpha; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px" start="start">
                                                            <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                              请求响应中的异常
                                                            </li>
                                                          </ol>
                                                          
                                                          <div style="margin-left: 40px">
                                                            在代理桥接器页上查找“Runtime statistics”下的“Exception objects created”。如果计数大于 0，则已经出现了一些异常。
                                                          </div>
                                                          
                                                          <div style="margin-left: 80px">
                                                          </div>
                                                          
                                                          <div style="margin-left: 40px">
                                                            还查找代理日志中的“Exception”。
                                                          </div>
                                                        </td>
                                                      </tr>
                                                    </table>
                                                    
                                                    <table style="width: 615px" border="1" cellspacing="2" cellpadding="2">
                                                      <tr>
                                                        <td style="background-color: rgb(204,204,204); font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                          <div align="left">
                                                            <b>出现错误后的代理桥接器页：</b></p> 
                                                            
                                                            <p>
                                                              <span style="font-family: &#39;courier new&#39;">requests:<span class="Apple-converted-space">&#160;</span></span><b style="font-family: &#39;courier new&#39;">6</b><span style="font-family: &#39;courier new&#39;"><span class="Apple-converted-space">&#160;</span></span>
                                                            </p>
                                                            
                                                            <p>
                                                              <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Exception objects created:<span class="Apple-converted-space">&#160;</span></span><b style="font-family: &#39;courier new&#39;">1</b><span style="font-family: &#39;courier new&#39;"><span class="Apple-converted-space">&#160;</span></span>
                                                            </p>
                                                            
                                                            <p>
                                                              <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">CONNECTION_REFUSED exceptions:<span class="Apple-converted-space">&#160;</span></span><span style="font-weight: bold"><span style="font-family: &#39;courier new&#39;">1</span></p> 
                                                              
                                                              <p>
                                                                </span><b>代理日志中的对应日志条目：</b>
                                                              </p>
                                                              
                                                              <p>
                                                                <span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:00 2004 attempt #0 out of a max of 5<span class="Apple-converted-space">&#160;</span></span>
                                                              </p>
                                                              
                                                              <p>
                                                                <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:00 2004 trying connect to PRIMARY &#8216;172.18.137.54&#8217;/38625 /65535 at line 1138 for &#8216;/mywebapp/session.jsp&#8217;<span class="Apple-converted-space">&#160;</span></span>
                                                              </p>
                                                              
                                                              <p>
                                                                <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:00 2004 INFO: New NON-SSL URL<span class="Apple-converted-space">&#160;</span></span>
                                                              </p>
                                                              
                                                              <p>
                                                                <br style="font-family: &#39;courier new&#39;" /><span style="font-family: &#39;courier new&#39;">Tue May 11 12:22:00 2004 *******Exception type [CONNECTION_REFUSED] (172.18.137.54:38625 errno = 0) raised at line 1536 of URL.cpp</span></div> </td> </tr> </tbody> </table> 
                                                                
                                                                <p>
                                                                  <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="#TOP">返回页首</a>
                                                                </p>
                                                                
                                                                <table style="text-align: left; width: 615px; height: 6px" cellspacing="2" cellpadding="2">
                                                                  <tr>
                                                                    <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                                      <b><u><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" name="Resolution"></a>解决方法</u></b><span class="Apple-converted-space">&#160;</span></p> 
                                                                      
                                                                      <p>
                                                                      </p>
                                                                      
                                                                      <ol style="line-height: 18px; list-style-type: lower-alpha; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                        <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                          如果被发现的问题是返回被截断列表的 X-WebLogic-Cluster-List，那么查明哪一个群集节点返回该响应并突出该节点。绝大多数情况下，问题是由于组播造成群集不稳定引起的。有关组播问题的诊断，请参阅<a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://blog.middleware123.com/support_pattern/Multicast_Pattern.html">组播错误</a>。
                                                                        </li>
                                                                        <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                          如果代理桥接器页报告有一些异常，则查明出现了什么类型的异常。
                                                                        </li>
                                                                      </ol>
                                                                      
                                                                      <div style="margin-left: 40px">
                                                                        如果问题未能得到解决，并且由于上述一个或两个原因继续影响常规服务器列表，那么您可以设置<code>&lt;font face="Arial, Helvetica, sans-serif">DynamicServerList="OFF"&lt;/font></code>，以使常规服务器列表将一直按配置包含完整的群集节点列表（静态列表）。有关详细信息，请参考<span class="Apple-converted-space">&#160;</span><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://edocs.bea.com/wls/docs81/plugins/plugin_params.html#1143055">General Parameters for Web Server Plug-Ins</a>（Web 服务器插件的常规参数），并查看 DynamicServerList 的说明。<code>&lt;span style="font-family: &#39;times new roman&#39;">但注意设置&lt;span class="Apple-converted-space">&#160;&lt;/span>&lt;/span>&lt;font face="Arial, Helvetica, sans-serif">DynamicServerList="OFF"&lt;/font>&lt;span class="Apple-converted-space">&#160;&lt;/span>&lt;span style="font-family: &#39;times new roman&#39;">的含义。&lt;/span></code>
                                                                      </div>
                                                                    </td>
                                                                  </tr>
                                                                </table>
                                                                
                                                                <p>
                                                                </p>
                                                                
                                                                <table style="text-align: left; width: 615px; height: 21px" cellspacing="2" cellpadding="2">
                                                                  <tr>
                                                                    <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                                      <b><u><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" name="External_Resources"></a>外部资源</p> 
                                                                      
                                                                      <p>
                                                                        </u></b>
                                                                      </p>
                                                                      
                                                                      <ul style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                        <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                          <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://edocs.bea.com/wls/docs81/plugins/plugin_params.html#1143055">General Parameters for Web Server Plug-Ins（Web 服务器插件的常规参数）</a>
                                                                        </li>
                                                                        <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                          <u><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://edocs.bea.com/wls/docs81/plugins/nsapi.html#113454">How the plug-in handles failover（插件如何处理 Failover）</a></u>
                                                                        </li>
                                                                      </ul></td> </tr> </tbody> </table> 
                                                                      
                                                                      <p>
                                                                        <a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="#TOP">返回页首</a>
                                                                      </p>
                                                                      
                                                                      <p>
                                                                        &#160;<span class="Apple-converted-space">&#160;</span>
                                                                      </p>
                                                                      
                                                                      <p>
                                                                        </div> 
                                                                        
                                                                        <table style="text-align: left; widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; width: 615px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" cellspacing="2" cellpadding="2">
                                                                          <tr>
                                                                            <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px; vertical-align: top">
                                                                              <span style="text-decoration: underline"><span style="font-weight: bold">是否需要更多帮助？</span></span></p> 
                                                                              
                                                                              <p>
                                                                                <span>如果您已经理解这个模式，但仍需要其它帮助，您可以：<br /> <br /></span>
                                                                              </p>
                                                                              
                                                                              <ol style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                                <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                                  <span>在<span class="Apple-converted-space">&#160;</span></span><span><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://support.bea.com/">http://support.bea.com/</a></span><span><span class="Apple-converted-space">&#160;</span></span><span>上查询 AskBEA（例如使用</span><span>“HTTP load balance problem”），以查找其它已发布的解决方案。</span>
                                                                                </li>
                                                                                <li style="line-height: 18px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px">
                                                                                  <span>在<span class="Apple-converted-space">&#160;</span></span><span><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://support.bea.com/">http://support.bea.com/</a></span><span><span class="Apple-converted-space">&#160;</span></span><span></span>上，向 BEA 的某个新闻组中提出更详细具体的问题。 <p>
                                                                                    </li> </ol> 
                                                                                    
                                                                                    <p>
                                                                                      如果这还不能解决您的问题，并且您拥有有效的技术支持合同，您可以通过登录以下网站来打开支持案例：<span><a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="http://support.bea.com/">http://support.bea.com/</a></span>。</td> </tr> </tbody> </table> 
                                                                                      
                                                                                      <p>
                                                                                        <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
                                                                                      </p>
                                                                                      
                                                                                      <table style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" border="1" width="615">
                                                                                        <tr>
                                                                                          <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px">
                                                                                            <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                                                                                              <strong>反馈</strong>
                                                                                            </p>
                                                                                            
                                                                                            <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                                                                                              <font color="#000000">请给我们提供您的意见，说明此支持诊断模式<strong>“使用代理插件时群集中的 HTTP 负载平衡问题”</strong>一文是否有所帮助，您需要的任何解释，以及对<a style="font-family: arial, verdana, helvetica, sans-serif; color: rgb(226,7,37); font-size: 12px; text-decoration: none" href="mailto:support.ke@bea.com?subject=Patterns%20Feedback:%20HTTP%20Load%20Balance%20Problem%20in%20Cluster%20Using%20Proxy%20Plug-in&body=">支持诊断模式</a>的新主题的任何要求。</p> 
                                                                                              
                                                                                              <p>
                                                                                                </font>
                                                                                              </p></td> </tr> </tbody> </table> 
                                                                                              
                                                                                              <p>
                                                                                                <br style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font: 12px/19px helvetica, arial, verdana, geneva, sans-serif; white-space: normal; orphans: 2; letter-spacing: normal; color: rgb(0,0,0); word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" />
                                                                                              </p>
                                                                                              
                                                                                              <table style="widows: 2; text-transform: none; background-color: rgb(255,255,255); text-indent: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; orphans: 2; letter-spacing: normal; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px" border="1" width="615">
                                                                                                <tr>
                                                                                                  <td style="font-family: 宋体; color: rgb(0,0,0); font-size: 12px" height="78">
                                                                                                    <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                                                                                                      <strong>免责声明：</strong>
                                                                                                    </p>
                                                                                                    
                                                                                                    <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                                                                                                      依据 BEA 与您签署的维护和支持协议条款，BEA Systems, Inc. 在本网站上提供技术技巧和修补程序供您使用。虽然您可以将这些信息和代码与您获得 BEA 授权的软件一起使用，但 BEA 并不对所提供的技术技巧和修补程序做任何形式的担保，无论是明确的还是隐含的。
                                                                                                    </p>
                                                                                                    
                                                                                                    <p style="line-height: 18px; margin-top: 0px; font-family: helvetica, arial, verdana, geneva, sans-serif; color: rgb(0,0,0); font-size: 12px; text-decoration: none">
                                                                                                      本文档中引用的任何商标是其各自所有者的财产。有关完整的商标信息，请参考您的产品手册。
                                                                                                    </p>
                                                                                                  </td>
                                                                                                </tr>
                                                                                              </table>
                                                                                              
                                                                                              <p>
                                                                                                转载请注明：<a href="http://www.beansoft.biz">WebLogic Android 博客</a> &raquo; <a href="http://www.beansoft.biz/2011/09/02/%e4%bd%bf%e7%94%a8%e4%bb%a3%e7%90%86%e6%8f%92%e4%bb%b6%e6%97%b6%e7%be%a4%e9%9b%86%e4%b8%ad%e7%9a%84-http-%e8%b4%9f%e8%bd%bd%e5%b9%b3%e8%a1%a1%e9%97%ae%e9%a2%98%e8%bd%ac/">使用代理插件时群集中的 HTTP 负载平衡问题[转]</a>
                                                                                              </p>