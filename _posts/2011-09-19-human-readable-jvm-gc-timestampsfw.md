---
id: 2258
title: 'Human readable JVM GC timestamps[FW]'
date: 2011-09-19T20:31:00+00:00
author: 刘长炯
layout: post
guid: http://www.beansoft.biz/?p=2258
permalink: /2011/09/19/human-readable-jvm-gc-timestampsfw/
views:
  - "3347"
original_post_id:
  - "2258"
image: /wp-content/uploads/2012/09/1257252433_java.png
categories:
  - JVM
tags:
  - GC
  - JVM
---
From: <http://www.theserverlabs.com/blog/2010/05/26/human-readable-jvm-gc-timestamps/>

   <span class="Apple-style-span" style="word-spacing:0;font:13px/20px verdana, &#039;text-transform:none;color:rgb(17,17,17);text-indent:0;white-space:normal;letter-spacing:normal;background-color:rgb(255,255,255);text-align:left;orphans:2;widows:2;"></p> 

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  When we are diagnosing problems in a Java (EE or otherwise) application, is often a good idea to check how garbage collection is performing. One of the basic and most unobtrusive actions is to enable garbage collection logging.
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  As you may know, if we add the following arguments to the java start command…
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  <code style="font:1em/1.5385 consolas, &#039;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">-Xloggc:&lt;file_name&gt; –XX:+PrintGCDetails -XX:+PrintGCDateStamps</code>
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  … the JVM will start writing garbage collection messages to the file we set with the parameter -Xlogcc. The messages should be something like:
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  <code style="font:1em/1.5385 consolas, &#039;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">       &lt;br />&lt;strong>2010-04-22T18:12:27.796+0200&lt;/strong>: 22.317: [GC 59030K-&gt;52906K(97244K), 0.0019061 secs]        &lt;br />&lt;strong>2010-04-22T18:12:27.828+0200&lt;/strong>: 22.348: [GC 59114K-&gt;52749K(97244K), 0.0021595 secs]        &lt;br />&lt;strong>2010-04-22T18:12:27.859+0200&lt;/strong>: 22.380: [GC 58957K-&gt;53335K(97244K), 0.0022615 secs]        &lt;br />&lt;strong>2010-04-22T18:12:27.890+0200&lt;/strong>: 22.409: [GC 59543K-&gt;53385K(97244K), 0.0024157 secs]        &lt;br /></code>
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  The bold part is simply the date and time when reported garbage collection event starts.
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  Unfortunately -XX:+PrintGCDateStamps is available only for Java 6 Update 4 and later JVMs. So, if we are unlucky and our application is running on older JVMs we are forced to use…
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  <code style="font:1em/1.5385 consolas, &#039;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">-Xloggc:&lt;file&gt; –XX:+PrintGCDetails</code>
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  … and the messages will be like:
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  <code style="font:1em/1.5385 consolas, &#039;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">       &lt;br />&lt;strong>22.317&lt;/strong>: [GC 59030K-&gt;52906K(97244K), 0.0019061 secs]        &lt;br />&lt;strong>22.348&lt;/strong>: [GC 59114K-&gt;52749K(97244K), 0.0021595 secs]        &lt;br />&lt;strong>22.380&lt;/strong>: [GC 58957K-&gt;53335K(97244K), 0.0022615 secs]        &lt;br />&lt;strong>22.409&lt;/strong>: [GC 59543K-&gt;53385K(97244K), 0.0024157 secs]        &lt;br /></code>
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  Now, the bold numbers (also present in previous format) are the seconds elapsed from JVM start time.
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  Mmm… way harder to correlate GC events with information from other log files in this case :/
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  Wouldn’t it be easier to process the gc log file and calculate date and time from seconds elapsed? It seems so, but seconds elapsed from… when? Or, putting it in other words, where do we extract the JVM startup date and time from?
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  In order to be as unobtrusive as possible, we should try to calculate the start date and time from the same GC log file. That brings us to the file attributes. We have different options:
</p>

<table style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;width:543px;color:rgb(68,68,68);border-bottom:rgb(204,204,204) 1px solid;border-collapse:collapse;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0 0 1.53em;padding:0;">
  <tr style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.2em 10px;">
      <strong>Unix</strong>
    </td>
    
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0 x;padding:.2em 10px;">
      <strong>Windows</strong>
    </td>
  </tr>
  
  <tr style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.2em 10px;">
      Access time
    </td>
    
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.2em 10px;">
      Access time
    </td>
  </tr>
  
  <tr style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.2em 10px;">
      Change time
    </td>
    
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.2em 10px;">
      Creation time
    </td>
  </tr>
  
  <tr style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.2em 10px;">
      Modify time
    </td>
    
    <td style="border-right:rgb(204,204,204) 1px solid;border-top:rgb(204,204,204) 1px solid;font-size:13px;vertical-align:baseline;border-left:rgb(204,204,204) 1px solid;border-bottom:rgb(204,204,204) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.2em 10px;">
      Modify time
    </td>
  </tr>
</table>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  We discard access time (for obvious reasons) and change time and creation time as they are not available in both platforms, so we are left with modification time, which represents the time when the file was last modified.
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  In Windows, modification time is maintained when the file is copied elsewhere, but<span class="Apple-converted-space">&#160;</span><strong>in Unix we should use the -p flag to preserve timestamp attributes if we want to copy the GC log file prior to our processing</strong>.
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  The last modification time of the GC log file should match the last timestamp recorded for a GC event in the log file. Well… for the purists, it should match exactly the last elapsed time plus the execution time (both in bold) as each log line is written piece by piece as it executes.
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  <code style="font:1em/1.5385 consolas, &#039;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">       &lt;br />&lt;strong>22.409&lt;/strong>: [GC 59543K-&gt;53385K(97244K),&lt;span class="Apple-converted-space">&#160;&lt;/span>&lt;strong>0.0024157&lt;/strong>&lt;span class="Apple-converted-space">&#160;&lt;/span>secs]        &lt;br /></code>
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  In our approach, we discard the execution time as we don’t need accurate precision to have a rough idea of what time each garbage collection event occurred. Nevertheless, keep in mind that GC execution time could sometimes be as long as several seconds in large heaps.
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  When we experienced this situation in a client recently, we needed to quickly develop a simple and portable script, so we used Python for the task. You already knew we don’t do just Java, didn’t you?<span class="Apple-converted-space">&#160;</span><img class="wp-smiley" style="font-size:13px;max-width:100%;vertical-align:baseline;height:auto;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;" alt=":P" src="http://www.theserverlabs.com/blog/wp-includes/images/smilies/icon_razz.gif" />
</p>

<div class="wp_syntax" style="border-right:silver 1px solid;border-top:silver 1px solid;font-size:13px;vertical-align:baseline;border-left:silver 1px solid;width:680px;color:rgb(17,0,0);border-bottom:silver 1px solid;background-color:rgb(249,249,249);outline-width:0;outline-style:initial;outline-color:initial;margin:0 0 1.5em;padding:0;">
  <div class="code" style="font-size:13px;vertical-align:top;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:2px 4px;">
    <pre class="python python" style="clear:none;border-right:rgb(221,221,221) 1px solid;border-top:rgb(221,221,221) 1px solid;float:none;font:1em/1.333 monospace;vertical-align:baseline;border-left:rgb(221,221,221) 1px solid;width:auto;border-bottom:rgb(221,221,221) 1px solid;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;margin:0;padding:.76em 10px;"><span style="font-size:12px;vertical-align:baseline;color:rgb(128,128,128);font-style:italic;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">#!/usr/bin/env python</span>&#160;&#160; <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">import</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">sys</span>, <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">os</span>, <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">datetime</span>&#160;&#160; <span style="font-size:12px;vertical-align:baseline;color:rgb(128,128,128);font-style:italic;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;"># true if string is a positive float</span>
<span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">def</span> validSeconds<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>str_sec<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>:
    <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">try</span>:
        <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">return</span> 0 <span style="font-size:12px;vertical-align:baseline;color:rgb(102,204,102);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">&lt;</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">float</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>str_sec<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
    <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">except</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">ValueError</span>:
        <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">return</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">False</span>&#160;&#160; <span style="font-size:12px;vertical-align:baseline;color:rgb(128,128,128);font-style:italic;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;"># show usage                </span>
<span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">if</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">len</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">sys</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">argv</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(102,204,102);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">&lt;</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(255,69,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">2</span>:
    <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">print</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(72,61,139);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">"Usage: %s &lt;gc.log&gt;"</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(102,204,102);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">%</span> <span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">sys</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">argv</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">[</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">]</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
    <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">sys</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">exit</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:rgb(255,69,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">1</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>&#160;&#160; file_str = <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">sys</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">argv</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">[</span><span style="font-size:12px;vertical-align:baseline;color:rgb(255,69,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">1</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">]</span>
lastmod_date = <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">datetime</span>.<span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">datetime</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">fromtimestamp</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">os</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">path</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">getmtime</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>file_str<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>&#160;&#160; <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">file</span> = <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">open</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>file_str, <span style="font-size:12px;vertical-align:baseline;color:rgb(72,61,139);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">'r'</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
lines = <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">file</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">readlines</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
<span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">file</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">close</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>&#160;&#160; <span style="font-size:12px;vertical-align:baseline;color:rgb(128,128,128);font-style:italic;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;"># get last elapsed time</span>
<span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">for</span> line <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">in</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">reversed</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>lines<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>:
    parts = line.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">split</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:rgb(72,61,139);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">':'</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
    <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">if</span> validSeconds<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>parts<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">[</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">]</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>:
        <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">break</span>&#160;&#160; <span style="font-size:12px;vertical-align:baseline;color:rgb(128,128,128);font-style:italic;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;"># calculate start time</span>
start_date = lastmod_date - <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">datetime</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">timedelta</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>seconds=<span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">float</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>parts<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">[</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">]</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>&#160;&#160; <span style="font-size:12px;vertical-align:baseline;color:rgb(128,128,128);font-style:italic;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;"># print file prepending human readable time where appropiate  </span>
<span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">for</span> line <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">in</span> lines:
    parts = line.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">split</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:rgb(72,61,139);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">':'</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
    <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">if</span> <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">not</span> validSeconds<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>parts<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">[</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">]</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>:
        <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">print</span> line.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">rstrip</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
        <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">continue</span>
    line_date = start_date + <span style="font-size:12px;vertical-align:baseline;color:rgb(220,20,60);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">datetime</span>.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">timedelta</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>seconds=<span style="font-size:12px;vertical-align:baseline;color:rgb(0,128,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">float</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>parts<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">[</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">]</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>
    <span style="font-weight:bold;font-size:12px;vertical-align:baseline;color:rgb(255,119,0);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">print</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(72,61,139);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">"%s: %s"</span> <span style="font-size:12px;vertical-align:baseline;color:rgb(102,204,102);background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">%</span> <span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span>line_date.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">isoformat</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span>, line.<span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">rstrip</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">(</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span><span style="font-size:12px;vertical-align:baseline;color:black;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">)</span></pre></p>
  </div></p>
</div>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  The script output can be redirected to another file, where we’ll have<br /> <br /><code style="font:1em/1.5385 consolas, &#039;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0;padding:0;">&lt;br />
      &lt;br />&lt;strong>2010-04-22T18:12:27.796375&lt;/strong>: 22.317: [GC 59030K-&gt;52906K(97244K), 0.0019061 secs]&lt;/p>
&lt;p>&lt;strong>2010-04-22T18:12:27.828375&lt;/strong>: 22.348: [GC 59114K-&gt;52749K(97244K), 0.0021595 secs]&lt;/p>
&lt;p>&lt;strong>2010-04-22T18:12:27.859375&lt;/strong>: 22.380: [GC 58957K-&gt;53335K(97244K), 0.0022615 secs]&lt;/p>
&lt;p>&lt;strong>2010-04-22T18:12:27.890375&lt;/strong>: 22.409: [GC 59543K-&gt;53385K(97244K), 0.0024157 secs]&lt;/p>
&lt;p></code>
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  You may note the date format is not 100% the same as the one with -XX:+PrintGCDateStamps argument, but it should be enough to get an idea of when each GC event happened (Timezone management in Python is way out of the scope of this blog entry).
</p>

<p style="font-size:13px;vertical-align:baseline;background-color:transparent;outline-width:0;outline-style:initial;outline-color:initial;border-width:0;margin:0 0 1.53em;padding:0;">
  This has been my first blog entry for The Server Labs and I hope some of you find it useful. Of course, all comments, suggestions and feedback are very welcome.
</p>

<p>
  </span>
</p>

<p>
  转载请注明：<a href="http://www.beansoft.biz">WebLogic Android 博客</a> &raquo; <a href="http://www.beansoft.biz/2011/09/19/human-readable-jvm-gc-timestampsfw/">Human readable JVM GC timestamps[FW]</a>
</p>