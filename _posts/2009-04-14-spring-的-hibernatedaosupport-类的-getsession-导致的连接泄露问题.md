---
id: 1254
title: Spring 的 HibernateDaoSupport 类的 getSession() 导致的连接泄露问题
date: 2009-04-14T06:52:00+00:00
author: 刘长炯
layout: post
guid: http://www.beansoft.biz/?p=1254
permalink: '/2009/04/14/spring-%e7%9a%84-hibernatedaosupport-%e7%b1%bb%e7%9a%84-getsession-%e5%af%bc%e8%87%b4%e7%9a%84%e8%bf%9e%e6%8e%a5%e6%b3%84%e9%9c%b2%e9%97%ae%e9%a2%98/'
views:
  - "4608"
original_post_id:
  - "1254"
categories:
  - Spring
---
2009-04-14 14:52 BeanSoft

Spring+Hibernate做项目, 发现有member在不加事务的情况下就去调用 getSession() 方法, 结果导致数据库连接不能释放, 也无法正常的提交事务(只能做查询, 不能做save(), update()). 如果配合连接池使用的话, 不出几分钟就会导致连接池无法拿到新连接的情况.

不过, 只要给DAO或者Service加入了事务, 就不会出现连接泄漏的问题.

谈谈解决方案:

最佳方案: 加入事务, 例如 tx 标签或者 @Transactional 都可以.

最笨方案: 修改代码, 使用 HibernateTemplate 来完成相关操作:

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">public</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">List queryAll( </span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">final</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">String hql, </span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">final</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Object&#8230; args) { </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>List list = getHibernateTemplate().executeFind(</span> <b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">new</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">HibernateCallback() { </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">public</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Object doInHibernate(Session session) </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">throws</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">HibernateException, SQLException { </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>Query query = session.createQuery(hql); </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">for</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">(</span> <b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">int</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">i =0; i < args.</span> <span style="font-family: 微软雅黑; color: #0000c0; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">length</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">; i++) { </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>query.setParameter(i, args[i]); </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>} </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span>
</p>

&#160;</p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>List list = query.list(); </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">return</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">list; </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>} </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>}); </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">return</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">list;<span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span>} <br style="mso-special-character: line-break" /> <br style="mso-special-character: line-break" /></span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">public</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Serializable save(Object entity) { </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">return</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">getHibernateTemplate().save(entity); </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span>} </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span>
</p>

但是缺陷显而易见, 要有N多的代码要进行改动.</p> 

<p class="MsoNormal">
  <span style="font-family: 微软雅黑; background: #e8f2fe; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">HibernateDaoSupport</span> <span style="font-family: 微软雅黑; background: #e8f2fe; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none">代码里面的原始说明文档指出直接调用<strong>getSession()</strong>方法必须用配套的<strong>releaseSession(Session session)</strong>来释放连接, 根据我的测试, 就算配置了 OpenSessionInViewFilter(前提: <u><strong>不加事务</strong></u>), 也不会关闭这个Session. 也许有人说可以用连接池, 这种情况和Db pool没关系, 用了pool就会发现连接很快就会满, 只会over的更快.&#160; 反过来, 如果不配置OpenSessionInViewFilter, 在DAO里提前用<strong> releaseSession()</strong>关闭连接, 就可能会在JSP中出现Lazy载入异常. 另一个不配事务的问题就是无法更新或者插入数据. 下面就是原始的JavaDoc中的说明:</span>
</p>

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">/** </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Obtain</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">a</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Hibernate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session,</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">either</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">from</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">current</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">transaction</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">or </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">a</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">new</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">one.</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">The</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">latter</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">is</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">only</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">allowed</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">if</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #3f3fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">{@link org.springframework.orm.hibernate3.HibernateTemplate#setAllowCreate "allowCreate"} </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">setting</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">of</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">this</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">bean&#8217;s</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #3f3fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">{@link #setHibernateTemplate HibernateTemplate}</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">is</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">"true". </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #0080ff; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><p><b></span> <span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Note</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">that</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">this</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">is</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">not</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">meant</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">to</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">be</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">invoked</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">from</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">HibernateTemplate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">code </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">but</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">rather</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">just</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">in</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">plain</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Hibernate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">code.</span> <span style="font-family: 微软雅黑; color: #0080ff; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></b></span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Either</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">rely</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">on</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">a</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">thread</span> <span style="font-family: 微软雅黑; color: #0080ff; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">&#8211;</span> <span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">bound </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">or</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">use</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">it</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">in</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">combination</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">with</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #3f3fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">{@link #releaseSession}</span> <span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">. </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #0080ff; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><p></span> <span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">In</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">general,</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">it</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">is</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">recommended</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">to</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">use</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">HibernateTemplate,</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">either</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">with </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">provided</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">convenience</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">operations</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">or</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">with</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">a</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">custom</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">HibernateCallback </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">that</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">provides</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">you</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">with</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">a</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">to</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">work</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">on.</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">HibernateTemplate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">will</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">care </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">for</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">all</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">resource</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">management</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">and</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">for</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">proper</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">exception</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">conversion. </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f9fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">@return</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Hibernate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f9fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">@throws</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">DataAccessResourceFailureException</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">if</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">couldn&#8217;t</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">be</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">created </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f9fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">@throws</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">IllegalStateException</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">if</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">no</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">thread</span> <span style="font-family: 微软雅黑; color: #0080ff; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">&#8211;</span> <span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">bound</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">found</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">and</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">allowCreate=false </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f9fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">@see</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">org.springframework.orm.hibernate3.SessionFactoryUtils#getSession(SessionFactory,</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">boolean) </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*/ </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">protected</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">final</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session getSession() </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">throws</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">DataAccessResourceFailureException, IllegalStateException { </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span>
</p>

&#160;</p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">return</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">getSession(</span> <b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">this</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">.</span> <span style="font-family: 微软雅黑; color: #0000c0; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">hibernateTemplate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">.isAllowCreate()); </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span>} </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span>
</p>

&#160;</p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">/** </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Close</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">given</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Hibernate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session,</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">created</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">via</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">this</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">DAO&#8217;s</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">SessionFactory, </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">if</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">it</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">isn&#8217;t</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">bound</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">to</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">thread</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">(i.e.</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">isn&#8217;t</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">a</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">transactional</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session). </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #0080ff; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><p></span> <span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Typically</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">used</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">in</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">plain</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Hibernate</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">code,</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">in</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">combination</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">with </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #3f3fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">{@link #getSession}</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">and</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: #3f3fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">{@link #convertHibernateAccessException}</span> <span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">. </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f9fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">@param</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">session</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">the</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">Session</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">to</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">close </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*</span> <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f9fbf; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">@see</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">org.springframework.orm.hibernate3.SessionFactoryUtils#releaseSession </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span> </span><span style="font-family: 微软雅黑; color: blue; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">*/ </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">protected</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">final</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span><b><span style="font-family: 微软雅黑; color: #7f0055; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">void</span> </b><span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE">releaseSession(Session session) { </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>SessionFactoryUtils.<i>releaseSession</i>(session, getSessionFactory()); </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160;&#160; </span>} </span>
</p></p> </p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; background: #e8f2fe; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span>
</p>

&#160;</p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span style="font-family: 微软雅黑; background: #e8f2fe; color: black; font-size: 11pt; mso-hansi-font-family: arial; mso-bidi-font-family: 微软雅黑; mso-font-kerning: 0pt; mso-ansi-language: x-none" lang="X-NONE"></span>
</p>

不需要改原始代码的最终方案(方案三):</p> 

<p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">
  <span lang="EN-US"></span>
</p>

不过, 如果项目里已经有了大量直接调用getSession()而且没有加入事务配置的代码(如历史原因导致), 这些代码太多, 没法一一修改, 那就最好寻求其它方案, 最好是不需要修改原来的Java代码的方案. 我采用的这第三个方案是重写</p> 

HibernateDaoSupport用ThreadLocal保存Session列表并编写一个配套的过滤器来显式关闭Session, 并在关闭之前尝试提交事务. 下面是重写的 HibernateDaoSupport 代码: 

<p class="MsoNormal">
  <span lang="EN-US"></span>
</p>

&#160;</p> 

<div>
  <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">						<span style="color: #0000ff">package</span> org.springframework.orm.hibernate3.support;<br /><br /><span style="color: #0000ff">import</span> java.text.SimpleDateFormat;<br /><span style="color: #0000ff">import</span> java.util.ArrayList;<br /><span style="color: #0000ff">import</span> java.util.List;<br /><br /><span style="color: #0000ff">import</span> org.hibernate.HibernateException;<br /><span style="color: #0000ff">import</span> org.hibernate.Session;<br /><span style="color: #0000ff">import</span> org.hibernate.SessionFactory;<br /><br /><span style="color: #0000ff">import</span> org.springframework.dao.DataAccessException;<br /><span style="color: #0000ff">import</span> org.springframework.dao.DataAccessResourceFailureException;<br /><span style="color: #0000ff">import</span> org.springframework.dao.support.DaoSupport;<br /><span style="color: #0000ff">import</span> org.springframework.orm.hibernate3.HibernateTemplate;<br /><span style="color: #0000ff">import</span> org.springframework.orm.hibernate3.SessionFactoryUtils;<br /><br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000"> * 修改后的避免连接泄漏的 HibernateDaoSupport, 多连接版本, 不保证跨DAO的事务.</span><br /><span style="color: #008000"> * </span><br /><span style="color: #008000"> * @author 刘长炯</span><br /><span style="color: #008000"> * Date: 2009-3-11</span><br /><span style="color: #008000"> */</span><br /><span style="color: #0000ff">public</span><span style="color: #0000ff">abstract</span><span style="color: #0000ff">class</span> HibernateDaoSupport <span style="color: #0000ff">extends</span> DaoSupport {<br /><span style="color: #008000">/** 使用 ThreadLocal 保存打开的 Session 列表 */</span><br /><span style="color: #0000ff">private</span><span style="color: #0000ff">static</span><span style="color: #0000ff">final</span> ThreadLocal&lt; List&lt;Session&gt; &gt; sessions = <span style="color: #0000ff">new</span> ThreadLocal&lt; List&lt;Session&gt; &gt;();<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * 获取Hibernate连接.</span><br /><span style="color: #008000">     * @return</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">public</span><span style="color: #0000ff">static</span> List&lt;Session&gt; getSessionList() {<br /><span style="color: #008000">//1. 先看看是否有了List get()</span><br />        List list = sessions.get();<br /><span style="color: #008000">// 2. 没有的话从创建一个, put()</span><br /><span style="color: #0000ff">if</span>(list == null) {<br />            list = <span style="color: #0000ff">new</span> ArrayList();<br />            sessions.set(list);<br />        }<br /><span style="color: #008000">// 3. 返回 Session</span><br /><span style="color: #0000ff">return</span> list;<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * 关闭当前线程中未正常释放的 Session.</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">public</span><span style="color: #0000ff">static</span><span style="color: #0000ff">void</span> closeSessionList() {<br /><span style="color: #008000">//        1. 先看看是否有了List get()</span><br />        List&lt;Session&gt; list = sessions.get();<br /><span style="color: #008000">// 2. 有的话就直接关闭</span><br /><span style="color: #0000ff">if</span>(list != null) {<br />            System.out.println(SimpleDateFormat.getDateTimeInstance().format(<span style="color: #0000ff">new</span> java.util.Date()) + <br /><span style="color: #006080">" -------- 即将释放未正常关闭的 Session"</span>);<br /><br /><br /><span style="color: #0000ff">for</span>(Session session : list) {<br />                System.out.println(<span style="color: #006080">"正在关闭 session ="</span> + session.hashCode());<br /><span style="color: #008000">// ! 关闭前事务提交</span><br /><span style="color: #0000ff">if</span>(session.isOpen()) {<br /><span style="color: #0000ff">try</span> {<br />                        session.getTransaction().commit();<br />                    } <span style="color: #0000ff">catch</span>(Exception ex) {<br /><span style="color: #0000ff">try</span> {<br />                            session.getTransaction().rollback();<br />                        } <span style="color: #0000ff">catch</span> (HibernateException e) {<br /><span style="color: #008000">// TODO Auto-generated catch block</span><br /><span style="color: #008000">//e.printStackTrace();</span><br />                        }<br />                    }<br /><span style="color: #0000ff">try</span> {<br />                        session.close();<br />                    } <span style="color: #0000ff">catch</span>(Exception ex) {<br /><br />                    }<br /><br />                }<br /><span style="color: #008000">//releaseSession(session); // 无法调用</span><br />            }<br />            sessions.remove();<br />        }<br /><br />    }<br /><br /><span style="color: #0000ff">private</span> HibernateTemplate hibernateTemplate;<br /><br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Set the Hibernate SessionFactory to be used by this DAO.</span><br /><span style="color: #008000">     * Will automatically create a HibernateTemplate for the given SessionFactory.</span><br /><span style="color: #008000">     * @see #createHibernateTemplate</span><br /><span style="color: #008000">     * @see #setHibernateTemplate</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">public</span><span style="color: #0000ff">final</span><span style="color: #0000ff">void</span> setSessionFactory(SessionFactory sessionFactory) {<br /><span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.hibernateTemplate == null || sessionFactory != <span style="color: #0000ff">this</span>.hibernateTemplate.getSessionFactory()) {<br /><span style="color: #0000ff">this</span>.hibernateTemplate = createHibernateTemplate(sessionFactory);<br />        }<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Create a HibernateTemplate for the given SessionFactory.</span><br /><span style="color: #008000">     * Only invoked if populating the DAO with a SessionFactory reference!</span><br /><span style="color: #008000">     * &lt;p&gt;Can be overridden in subclasses to provide a HibernateTemplate instance</span><br /><span style="color: #008000">     * with different configuration, or a custom HibernateTemplate subclass.</span><br /><span style="color: #008000">     * @param sessionFactory the Hibernate SessionFactory to create a HibernateTemplate for</span><br /><span style="color: #008000">     * @return the new HibernateTemplate instance</span><br /><span style="color: #008000">     * @see #setSessionFactory</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">protected</span> HibernateTemplate createHibernateTemplate(SessionFactory sessionFactory) {<br /><span style="color: #0000ff">return</span><span style="color: #0000ff">new</span> HibernateTemplate(sessionFactory);<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Return the Hibernate SessionFactory used by this DAO.</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">public</span><span style="color: #0000ff">final</span> SessionFactory getSessionFactory() {<br /><span style="color: #0000ff">return</span> (<span style="color: #0000ff">this</span>.hibernateTemplate != null ? <span style="color: #0000ff">this</span>.hibernateTemplate.getSessionFactory() : null);<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Set the HibernateTemplate for this DAO explicitly,</span><br /><span style="color: #008000">     * as an alternative to specifying a SessionFactory.</span><br /><span style="color: #008000">     * @see #setSessionFactory</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">public</span><span style="color: #0000ff">final</span><span style="color: #0000ff">void</span> setHibernateTemplate(HibernateTemplate hibernateTemplate) {<br /><span style="color: #0000ff">this</span>.hibernateTemplate = hibernateTemplate;<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Return the HibernateTemplate for this DAO,</span><br /><span style="color: #008000">     * pre-initialized with the SessionFactory or set explicitly.</span><br /><span style="color: #008000">     * &lt;p&gt;&lt;b&gt;Note: The returned HibernateTemplate is a shared instance.&lt;/b&gt;</span><br /><span style="color: #008000">     * You may introspect its configuration, but not modify the configuration</span><br /><span style="color: #008000">     * (other than from within an {@link #initDao} implementation).</span><br /><span style="color: #008000">     * Consider creating a custom HibernateTemplate instance via</span><br /><span style="color: #008000">     * &lt;code&gt;new HibernateTemplate(getSessionFactory())&lt;/code&gt;, in which</span><br /><span style="color: #008000">     * case you're allowed to customize the settings on the resulting instance.</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">public</span><span style="color: #0000ff">final</span> HibernateTemplate getHibernateTemplate() {<br /><span style="color: #0000ff">return</span><span style="color: #0000ff">this</span>.hibernateTemplate;<br />    }<br /><br /><span style="color: #0000ff">protected</span><span style="color: #0000ff">final</span><span style="color: #0000ff">void</span> checkDaoConfig() {<br /><span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.hibernateTemplate == null) {<br /><span style="color: #0000ff">throw</span><span style="color: #0000ff">new</span> IllegalArgumentException(<span style="color: #006080">"'sessionFactory' or 'hibernateTemplate' is required"</span>);<br />        }<br />    }<br /><br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Obtain a Hibernate Session, either from the current transaction or</span><br /><span style="color: #008000">     * a new one. The latter is only allowed if the</span><br /><span style="color: #008000">     * {@link org.springframework.orm.hibernate3.HibernateTemplate#setAllowCreate "allowCreate"}</span><br /><span style="color: #008000">     * setting of this bean's {@link #setHibernateTemplate HibernateTemplate} is "true".</span><br /><span style="color: #008000">     * &lt;p&gt;&lt;b&gt;Note that this is not meant to be invoked from HibernateTemplate code</span><br /><span style="color: #008000">     * but rather just in plain Hibernate code.&lt;/b&gt; Either rely on a thread-bound</span><br /><span style="color: #008000">     * Session or use it in combination with {@link #releaseSession}.</span><br /><span style="color: #008000">     * &lt;p&gt;In general, it is recommended to use HibernateTemplate, either with</span><br /><span style="color: #008000">     * the provided convenience operations or with a custom HibernateCallback</span><br /><span style="color: #008000">     * that provides you with a Session to work on. HibernateTemplate will care</span><br /><span style="color: #008000">     * for all resource management and for proper exception conversion.</span><br /><span style="color: #008000">     * @return the Hibernate Session</span><br /><span style="color: #008000">     * @throws DataAccessResourceFailureException if the Session couldn't be created</span><br /><span style="color: #008000">     * @throws IllegalStateException if no thread-bound Session found and allowCreate=false</span><br /><span style="color: #008000">     * @see org.springframework.orm.hibernate3.SessionFactoryUtils#getSession(SessionFactory, boolean)</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">protected</span><span style="color: #0000ff">final</span> Session getSession()<br /><span style="color: #0000ff">throws</span> DataAccessResourceFailureException, IllegalStateException {<br />        Session session = getSession(<span style="color: #0000ff">this</span>.hibernateTemplate.isAllowCreate());<br /><br /><span style="color: #008000">// 开始事务</span><br /><span style="color: #0000ff">try</span> {<br />            session.beginTransaction();<br />        } <span style="color: #0000ff">catch</span> (HibernateException e) {<br />            e.printStackTrace();<br />        }<br /><br />        getSessionList().add(session);<br /><br /><span style="color: #0000ff">return</span> session;<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Obtain a Hibernate Session, either from the current transaction or</span><br /><span style="color: #008000">     * a new one. The latter is only allowed if "allowCreate" is true.</span><br /><span style="color: #008000">     * &lt;p&gt;&lt;b&gt;Note that this is not meant to be invoked from HibernateTemplate code</span><br /><span style="color: #008000">     * but rather just in plain Hibernate code.&lt;/b&gt; Either rely on a thread-bound</span><br /><span style="color: #008000">     * Session or use it in combination with {@link #releaseSession}.</span><br /><span style="color: #008000">     * &lt;p&gt;In general, it is recommended to use</span><br /><span style="color: #008000">     * {@link #getHibernateTemplate() HibernateTemplate}, either with</span><br /><span style="color: #008000">     * the provided convenience operations or with a custom</span><br /><span style="color: #008000">     * {@link org.springframework.orm.hibernate3.HibernateCallback} that</span><br /><span style="color: #008000">     * provides you with a Session to work on. HibernateTemplate will care</span><br /><span style="color: #008000">     * for all resource management and for proper exception conversion.</span><br /><span style="color: #008000">     * @param allowCreate if a non-transactional Session should be created when no</span><br /><span style="color: #008000">     * transactional Session can be found for the current thread</span><br /><span style="color: #008000">     * @return the Hibernate Session</span><br /><span style="color: #008000">     * @throws DataAccessResourceFailureException if the Session couldn't be created</span><br /><span style="color: #008000">     * @throws IllegalStateException if no thread-bound Session found and allowCreate=false</span><br /><span style="color: #008000">     * @see org.springframework.orm.hibernate3.SessionFactoryUtils#getSession(SessionFactory, boolean)</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">protected</span><span style="color: #0000ff">final</span> Session getSession(<span style="color: #0000ff">boolean</span> allowCreate)<br /><span style="color: #0000ff">throws</span> DataAccessResourceFailureException, IllegalStateException {<br /><br /><span style="color: #0000ff">return</span>  (!allowCreate ?<br />            SessionFactoryUtils.getSession(getSessionFactory(), false) :<br />                SessionFactoryUtils.getSession(<br />                        getSessionFactory(),<br /><span style="color: #0000ff">this</span>.hibernateTemplate.getEntityInterceptor(),<br /><span style="color: #0000ff">this</span>.hibernateTemplate.getJdbcExceptionTranslator()));<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Convert the given HibernateException to an appropriate exception from the</span><br /><span style="color: #008000">     * &lt;code&gt;org.springframework.dao&lt;/code&gt; hierarchy. Will automatically detect</span><br /><span style="color: #008000">     * wrapped SQLExceptions and convert them accordingly.</span><br /><span style="color: #008000">     * &lt;p&gt;Delegates to the</span><br /><span style="color: #008000">     * {@link org.springframework.orm.hibernate3.HibernateTemplate#convertHibernateAccessException}</span><br /><span style="color: #008000">     * method of this DAO's HibernateTemplate.</span><br /><span style="color: #008000">     * &lt;p&gt;Typically used in plain Hibernate code, in combination with</span><br /><span style="color: #008000">     * {@link #getSession} and {@link #releaseSession}.</span><br /><span style="color: #008000">     * @param ex HibernateException that occured</span><br /><span style="color: #008000">     * @return the corresponding DataAccessException instance</span><br /><span style="color: #008000">     * @see org.springframework.orm.hibernate3.SessionFactoryUtils#convertHibernateAccessException</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">protected</span><span style="color: #0000ff">final</span> DataAccessException convertHibernateAccessException(HibernateException ex) {<br /><span style="color: #0000ff">return</span><span style="color: #0000ff">this</span>.hibernateTemplate.convertHibernateAccessException(ex);<br />    }<br /><br /><span style="color: #008000">/**</span><br /><span style="color: #008000">     * Close the given Hibernate Session, created via this DAO's SessionFactory,</span><br /><span style="color: #008000">     * if it isn't bound to the thread (i.e. isn't a transactional Session).</span><br /><span style="color: #008000">     * &lt;p&gt;Typically used in plain Hibernate code, in combination with</span><br /><span style="color: #008000">     * {@link #getSession} and {@link #convertHibernateAccessException}.</span><br /><span style="color: #008000">     * @param session the Session to close</span><br /><span style="color: #008000">     * @see org.springframework.orm.hibernate3.SessionFactoryUtils#releaseSession</span><br /><span style="color: #008000">     */</span><br /><span style="color: #0000ff">protected</span><span style="color: #0000ff">final</span><span style="color: #0000ff">void</span> releaseSession(Session session) {<br />        SessionFactoryUtils.releaseSession(session, getSessionFactory());<br />    }<br /><br />}<br /></pre>
</div>

<div>
  用这个类来覆盖Spring内置的那个HibernateDaoSupport, 然后随便编写一个过滤器, 如下所示:
</div>

<div id="codeSnippetWrapper">
  <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">						<span style="color: #0000ff">public</span>
						<span style="color: #0000ff">void</span> doFilter(ServletRequest req, ServletResponse res,<br />        FilterChain chain) <span style="color: #0000ff">throws</span> IOException, ServletException {<br /><br />    req.setCharacterEncoding(<span style="color: #0000ff">this</span>.charset);<br />    chain.doFilter(req, res);<br /><span style="color: #008000">// 关闭遗漏的 Session</span><br />    HibernateDaoSupport.closeSessionList();<br />}</pre>
  
  <p>
    </div> 
    
    <div>
    </div>
  </p>
  
  <p>
    把这个过滤器配置在过滤器链的第一个, 就OK了.
  </p>
  
  <p>
    最后也许会有人说, 为什么不用tx标签在Spring中来配置一个通配符就全部加入了事务了呢? 不过很遗憾, 经测试发现此方式无法实现跨DAO的Hibernate事务, 所以只好很无奈的放弃了这种方式. 这就是文章一开头提到的最佳方案, 也许是成本最低的方案了, 但是我却没采用, 一是因为事务问题, 二是因为每个有问题的dao/service包都要修改一次XML配置文件, 我很懒惰, 不想去看那些代码都在哪些包里面. Tx标签的配置方式如下所示:
  </p>
  
  <div id="codeSnippetWrapper">
    <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">						<span style="color: #0000ff">&lt;?</span>
						<span style="color: #800000">xml</span>
						<span style="color: #ff0000">version</span>
						<span style="color: #0000ff">="1.0"</span>
						<span style="color: #ff0000">encoding</span>
						<span style="color: #0000ff">="UTF-8"</span>?<span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">beans</span><span style="color: #ff0000">xmlns</span><span style="color: #0000ff">="http://www.springframework.org/schema/beans"</span><br /><span style="color: #ff0000">xmlns:xsi</span><span style="color: #0000ff">="http://www.w3.org/2001/XMLSchema-instance"</span><br /><span style="color: #ff0000">xmlns:aop</span><span style="color: #0000ff">="http://www.springframework.org/schema/aop"</span><br /><span style="color: #ff0000">xmlns:tx</span><span style="color: #0000ff">="http://www.springframework.org/schema/tx"</span><br /><span style="color: #ff0000">xsi:schemaLocation</span><span style="color: #0000ff">="<br />       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd<br />       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd<br />       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd"</span><span style="color: #0000ff">&gt;</span><br /><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">bean</span><span style="color: #ff0000">id</span><span style="color: #0000ff">="sessionFactory"</span><br /><span style="color: #ff0000">class</span><span style="color: #0000ff">="org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">property</span><span style="color: #ff0000">name</span><span style="color: #0000ff">="configLocation"</span><br /><span style="color: #ff0000">value</span><span style="color: #0000ff">="classpath:hibernate.cfg.xml"</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">property</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">bean</span><span style="color: #0000ff">&gt;</span><br /><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">bean</span><span style="color: #ff0000">id</span><span style="color: #0000ff">="StudentDAO"</span><span style="color: #ff0000">class</span><span style="color: #0000ff">="dao.StudentDAO"</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">property</span><span style="color: #ff0000">name</span><span style="color: #0000ff">="sessionFactory"</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">ref</span><span style="color: #ff0000">bean</span><span style="color: #0000ff">="sessionFactory"</span><span style="color: #0000ff">/&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">property</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">bean</span><span style="color: #0000ff">&gt;</span><br /><br /><span style="color: #008000">&lt;!-- 声明一个 Hibernate 3 的 事务管理器供代理类自动管理事务用 --&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">bean</span><span style="color: #ff0000">id</span><span style="color: #0000ff">="transactionManager"</span><br /><span style="color: #ff0000">class</span><span style="color: #0000ff">="org.springframework.orm.hibernate3.HibernateTransactionManager"</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">property</span><span style="color: #ff0000">name</span><span style="color: #0000ff">="sessionFactory"</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">ref</span><span style="color: #ff0000">local</span><span style="color: #0000ff">="sessionFactory"</span><span style="color: #0000ff">/&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">property</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">bean</span><span style="color: #0000ff">&gt;</span><br /><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">aop:config</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #008000">&lt;!-- 切入点指明了在执行dao.StudentDAO的所有方法时产生事务拦截操作 --&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">aop:pointcut</span><span style="color: #ff0000">id</span><span style="color: #0000ff">="daoMethods"</span><br /><span style="color: #ff0000">expression</span><span style="color: #0000ff">="execution(* dao.StudentDAO.*(..))"</span><span style="color: #0000ff">/&gt;</span><br /><span style="color: #008000">&lt;!-- 定义了将采用何种拦截操作，这里引用到 txAdvice --&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">aop:advisor</span><span style="color: #ff0000">advice-ref</span><span style="color: #0000ff">="txAdvice"</span><br /><span style="color: #ff0000">pointcut-ref</span><span style="color: #0000ff">="daoMethods"</span><span style="color: #0000ff">/&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">aop:config</span><span style="color: #0000ff">&gt;</span><br /><br /><span style="color: #008000">&lt;!-- 这是事务通知操作，使用的事务管理器引用自 transactionManager --&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">tx:advice</span><span style="color: #ff0000">id</span><span style="color: #0000ff">="txAdvice"</span><span style="color: #ff0000">transaction-manager</span><span style="color: #0000ff">="transactionManager"</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">tx:attributes</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #008000">&lt;!-- 指定哪些方法需要加入事务，这里懒惰一下全部加入，可以使用通配符来只加入需要的方法 --&gt;</span><br /><span style="color: #0000ff">&lt;</span><span style="color: #800000">tx:method</span><span style="color: #ff0000">name</span><span style="color: #0000ff">="*"</span><span style="color: #ff0000">propagation</span><span style="color: #0000ff">="REQUIRED"</span><span style="color: #0000ff">/&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">tx:attributes</span><span style="color: #0000ff">&gt;</span><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">tx:advice</span><span style="color: #0000ff">&gt;</span><br /><br /><span style="color: #0000ff">&lt;/</span><span style="color: #800000">beans</span><span style="color: #0000ff">&gt;</span></pre>
    
    <p>
      </div> 
      
      <p>
        其它加事务的方式有老式的Spring1.2的, 还有Annotation的, 这些都是一个解决方案, 就是给DAO/Service加入事务. 如果您有更好的办法, 欢迎来信探讨.
      </p>
      
      <p>
        <a href="/beansoft/archive/2008/08/17/222589.html"><img src="/images/blogjava_net/beansoft/24572/o_book-3d-box.jpg" /> </a>
      </p>
      
      <p>
        转载请注明：<a href="http://www.beansoft.biz">WebLogic Android 博客</a> &raquo; <a href="http://www.beansoft.biz/2009/04/14/spring-%e7%9a%84-hibernatedaosupport-%e7%b1%bb%e7%9a%84-getsession-%e5%af%bc%e8%87%b4%e7%9a%84%e8%bf%9e%e6%8e%a5%e6%b3%84%e9%9c%b2%e9%97%ae%e9%a2%98/">Spring 的 HibernateDaoSupport 类的 getSession() 导致的连接泄露问题</a>
      </p>